<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VeoMuse - 文字/图片生成视频</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/main.css">
</head>
<body>
    <div class="container">
        <!-- 头部区域 -->
        <div class="header">
            <button class="theme-toggle" id="theme-toggle">🌙</button>
            <h1>VeoMuse</h1>
            <p>使用Gemini Veo模型将文字或图片生成视频</p>
        </div>
        
        <!-- API警告提示 -->
        <div class="api-warning">
            <strong>重要提示：</strong>Gemini Veo模型目前仅在付费层级可用，免费层级的API密钥无法使用此功能。您需要一个有效的付费API密钥才能生成视频。
        </div>
        
        <!-- API密钥配置区域 -->
        <div class="api-key-section">
            <div class="form-group">
                <label for="api-key">临时API密钥 (非持久化):</label>
                <input type="password" id="api-key" placeholder="输入您的Gemini API密钥以临时使用">
            </div>
        </div>
        
        <!-- 选项卡导航 -->
        <div class="tabs">
            <button class="tab active" data-tab="text">文字生成视频</button>
            <button class="tab" data-tab="image">图片生成视频</button>
            <button class="tab" data-tab="history">生成历史</button>
            <button class="tab" data-tab="api">API文档</button>
        </div>
        
        <!-- 文字生成视频选项卡 -->
        <div class="tab-content active" id="text-content">
            <!-- 提示词模板快速选择 -->
            <div class="template-quick-select">
                <h3>🎨 提示词模板快速选择</h3>
                <div class="template-categories-compact" id="template-categories-compact">
                    <!-- 模板分类将在JavaScript中动态生成 -->
                </div>
                <div class="template-quick-actions">
                    <button id="random-template-text-btn" class="btn btn-sm btn-info">🎲 随机获取模板</button>
                    <button id="show-all-templates-btn" class="btn btn-sm btn-secondary">📚 查看所有模板</button>
                </div>
            </div>
            
            <div class="form-group">
                <label for="text-input">输入文字描述:</label>
                <textarea id="text-input" placeholder="请输入您想要生成视频的文字描述，越详细越好...例如：广角镜头：一只可爱的雪豹在冬季森林中欢快地跳跃，场景中有圆润的雪树和缓缓飘落的雪花。"></textarea>
            </div>
            
            <!-- 风格选择 -->
            <div class="form-group">
                <label for="style-select-text">选择视频风格:</label>
                <select id="style-select-text">
                    <option value="">默认风格</option>
                    <option value="写实风格">写实风格 - 真实感强，细节丰富</option>
                    <option value="动画风格">动画风格 - 卡通动画，色彩鲜艳</option>
                    <option value="电影风格">电影风格 - 电影级画质，戏剧性光影</option>
                    <option value="梦幻风格">梦幻风格 - 梦幻般视觉效果</option>
                    <option value="复古风格">复古风格 - 怀旧复古感，温暖色调</option>
                    <option value="科幻风格">科幻风格 - 未来感科技风格</option>
                </select>
            </div>
            
            <div class="optimize-section">
                <button id="optimize-text-btn" class="btn btn-info">AI优化提示词</button>
                <select id="optimize-model-text">
                    <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                    <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                    <option value="gemini-2.0-flash">Gemini 2.0 Flash</option>
                </select>
            </div>
            
            <div class="optimized-prompt" id="optimized-text-prompt">
                <h4>优化后的提示词:</h4>
                <p id="optimized-text-content"></p>
            </div>
            
            <div class="form-group">
                <label for="negative-prompt-text">负面提示 (可选):</label>
                <input type="text" id="negative-prompt-text" placeholder="描述您不希望在视频中出现的内容，例如：卡通、低质量、模糊">
            </div>
            
            <div class="model-selection">
                <div class="model-option">
                    <label for="video-model-text">视频生成模型:</label>
                    <select id="video-model-text">
                        <option value="veo-3.0-generate-preview">Veo 3.0 (Preview)</option>
                        <option value="veo-3.0-fast-generate-preview">Veo 3.0 Fast (Preview)</option>
                        <option value="veo-2.0-generate-001">Veo 2.0</option>
                    </select>
                </div>
            </div>
            
            <button id="generate-text-btn" class="btn">生成视频</button>
        </div>
        
        <!-- 图片生成视频选项卡 -->
        <div class="tab-content" id="image-content">
            <div class="form-group">
                <label for="image-input">上传图片:</label>
                <input type="file" id="image-input" accept="image/*">
            </div>
            
            <!-- 图片相关的提示词模板 -->
            <div class="template-quick-select">
                <h3>🎨 图片视频模板快速选择</h3>
                <div class="template-categories-compact" id="template-categories-image">
                    <!-- 图片相关模板将在JavaScript中动态生成 -->
                </div>
                <div class="template-quick-actions">
                    <button id="random-template-image-btn" class="btn btn-sm btn-info">🎲 随机获取模板</button>
                </div>
            </div>
            
            <div class="form-group">
                <label for="image-prompt">图片描述:</label>
                <textarea id="image-prompt" placeholder="详细描述您希望如何基于这张图片生成视频...例如：图片中的雪豹开始在雪地中奔跑，雪花飞舞。"></textarea>
            </div>
            
            <!-- 风格选择 -->
            <div class="form-group">
                <label for="style-select-image">选择视频风格:</label>
                <select id="style-select-image">
                    <option value="">默认风格</option>
                    <option value="写实风格">写实风格 - 真实感强，细节丰富</option>
                    <option value="动画风格">动画风格 - 卡通动画，色彩鲜艳</option>
                    <option value="电影风格">电影风格 - 电影级画质，戏剧性光影</option>
                    <option value="梦幻风格">梦幻风格 - 梦幻般视觉效果</option>
                    <option value="复古风格">复古风格 - 怀旧复古感，温暖色调</option>
                    <option value="科幻风格">科幻风格 - 未来感科技风格</option>
                </select>
            </div>
            
            <div class="optimize-section">
                <button id="optimize-image-btn" class="btn btn-info">AI优化提示词</button>
                <select id="optimize-model-image">
                    <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                    <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                    <option value="gemini-2.0-flash">Gemini 2.0 Flash</option>
                </select>
            </div>
            
            <div class="optimized-prompt" id="optimized-image-prompt">
                <h4>优化后的提示词:</h4>
                <p id="optimized-image-content"></p>
            </div>
            
            <div class="form-group">
                <label for="negative-prompt-image">负面提示 (可选):</label>
                <input type="text" id="negative-prompt-image" placeholder="描述您不希望在视频中出现的内容">
            </div>
            
            <div class="model-selection">
                <div class="model-option">
                    <label for="video-model-image">视频生成模型:</label>
                    <select id="video-model-image">
                        <option value="veo-3.0-generate-preview">Veo 3.0 (Preview)</option>
                        <option value="veo-3.0-fast-generate-preview">Veo 3.0 Fast (Preview)</option>
                        <option value="veo-2.0-generate-001">Veo 2.0</option>
                    </select>
                </div>
            </div>
            
            <div id="image-preview" class="preview"></div>
            <button id="generate-image-btn" class="btn">生成视频</button>
        </div>
        
        
        <!-- 生成历史选项卡 -->
        <div class="tab-content" id="history-content">
            <div class="history-header">
                <h2>生成历史</h2>
                <button id="clear-history-btn" class="btn btn-warning">清空历史</button>
            </div>
            
            <div class="history-list" id="history-list">
                <!-- 历史记录将在JavaScript中动态生成 -->
            </div>
            
            <div class="history-empty" id="history-empty" style="display: none;">
                <p>暂无生成历史，开始创建您的第一个视频吧！</p>
            </div>
        </div>
        
        <!-- API文档选项卡 -->
        <div class="tab-content" id="api-content">
            <h2>API文档</h2>
            <p>以下是VeoMuse应用程序提供的API接口文档。</p>
            
            <div class="api-docs">
                <h3>基础信息</h3>
                <p><strong>Base URL:</strong> <code>http://localhost:3000/api</code></p>
                <p><strong>认证:</strong> 所有API端点都需要有效的Gemini API密钥。您可以通过环境变量配置或在请求中提供API密钥。</p>
                
                <h3>模型接口</h3>
                <h4>获取可用模型</h4>
                <p><strong>Endpoint:</strong> <code>GET /models</code></p>
                <p><strong>查询参数:</strong></p>
                <ul>
                    <li><code>apiKey</code> (可选): 您的Gemini API密钥</li>
                </ul>
                <p><strong>响应示例:</strong></p>
                <pre><code>{
  "videoModels": [
    {
      "id": "veo-3.0-generate-preview",
      "name": "Veo 3.0 (Preview)"
    }
  ],
  "optimizationModels": [
    {
      "id": "gemini-2.5-pro",
      "name": "Gemini 2.5 Pro"
    }
  ]
}</code></pre>
                
                <h3>文字生成视频</h3>
                <h4>生成视频</h4>
                <p><strong>Endpoint:</strong> <code>POST /text-to-video</code></p>
                <p><strong>请求体:</strong></p>
                <pre><code>{
  "text": "A beautiful sunset over the ocean",
  "negativePrompt": "blurry, low quality",
  "apiKey": "your-api-key",
  "model": "veo-3.0-generate-preview",
  "optimize": true,
  "socketId": "socket-id-for-realtime-updates"
}</code></pre>
                
                <h3>图片生成视频</h3>
                <h4>生成视频</h4>
                <p><strong>Endpoint:</strong> <code>POST /image-to-video</code></p>
                <p><strong>表单数据:</strong></p>
                <ul>
                    <li><code>image</code>: 要上传的图片文件</li>
                    <li><code>prompt</code>: 如何生成视频的描述</li>
                    <li><code>negativePrompt</code>: 要避免的元素</li>
                    <li><code>apiKey</code>: 您的API密钥</li>
                    <li><code>model</code>: 使用的模型</li>
                </ul>
                
                <h3>提示词优化</h3>
                <h4>优化提示词</h4>
                <p><strong>Endpoint:</strong> <code>POST /optimize-prompt</code></p>
                <p><strong>请求体:</strong></p>
                <pre><code>{
  "prompt": "A cat playing",
  "apiKey": "your-api-key",
  "model": "gemini-2.5-pro"
}</code></pre>
                
                <h3>视频管理</h3>
                <h4>下载生成的视频</h4>
                <p><strong>Endpoint:</strong> <code>POST /download-video</code></p>
                <h4>转码视频</h4>
                <p><strong>Endpoint:</strong> <code>POST /transcode-video</code></p>
                
                <h3>健康检查</h3>
                <p><strong>Endpoint:</strong> <code>GET /health</code></p>
            </div>
        </div>
        
        <!-- 加载状态 -->
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <div class="status-text" id="status-text">正在初始化视频生成...</div>
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
            <p>正在生成视频，请稍候...</p>
            <p style="font-size: 0.9rem; margin-top: 10px;">Gemini Veo模型正在处理您的请求</p>
        </div>
        
        <!-- 结果显示 -->
        <div class="result" id="result">
            <h3>生成完成!</h3>
            <div id="video-container"></div>
            
            <div class="conversion-section">
                <h3>视频转换</h3>
                <div class="conversion-options">
                    <div class="conversion-option">
                        <label for="convert-format">目标格式:</label>
                        <select id="convert-format">
                            <option value="mp4">MP4</option>
                            <option value="webm">WebM</option>
                            <option value="mov">MOV</option>
                        </select>
                    </div>
                    <div class="conversion-option">
                        <label for="convert-resolution">分辨率:</label>
                        <select id="convert-resolution">
                            <option value="">保持原分辨率</option>
                            <option value="480p">480p</option>
                            <option value="720p">720p</option>
                            <option value="1080p">1080p</option>
                        </select>
                    </div>
                    <div class="conversion-option">
                        <label for="convert-fps">帧率:</label>
                        <select id="convert-fps">
                            <option value="">保持原帧率</option>
                            <option value="24">24 FPS</option>
                            <option value="30">30 FPS</option>
                            <option value="60">60 FPS</option>
                        </select>
                    </div>
                </div>
                <button id="convert-btn" class="btn btn-warning">转换视频</button>
                
                <div class="transcode-progress" id="transcode-progress">
                    <div class="status-text" id="transcode-status-text">正在初始化视频转换...</div>
                    <div class="progress-bar">
                        <div class="progress" id="transcode-progress-bar"></div>
                    </div>
                </div>
            </div>
            
            <div class="conversion-preview" id="conversion-preview">
                <h3>转换完成!</h3>
                <div id="converted-video-container"></div>
                <button id="download-converted-btn" class="btn btn-success" style="margin-top: 15px;">下载转换后的视频</button>
            </div>
            
            <div class="video-actions">
                <button id="download-btn" class="btn">下载原始视频</button>
            </div>
        </div>
        
        <!-- 页脚 -->
        <div class="footer">
            <p>© 2025 VeoMuse - 文字/图片生成视频工具 | 基于Google Gemini Veo模型</p>
            <p style="font-size: 0.8rem; margin-top: 10px;">注意：Gemini Veo模型目前仅在付费层级可用</p>
        </div>
    </div>
    
    <!-- 通知提示 -->
    <div class="notification" id="notification"></div>
    
    <!-- 模板弹窗 -->
    <div class="modal" id="template-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>🎨 提示词模板库</h2>
                <span class="close" id="close-template-modal">&times;</span>
            </div>
            <div class="modal-body">
                <p>选择一个模板直接应用到输入框中，立即开始生成视频。</p>
                
                <div class="template-categories" id="template-categories-modal">
                    <!-- 模板分类将在JavaScript中动态生成 -->
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript模块 -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/ui-managers.js"></script>
    <script src="/js/api-client.js"></script>
    <script src="/js/app.js"></script>
    <script src="/js/features.js"></script>
</body>
</html>