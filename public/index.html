<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VeoMuse - AI 视频创作平台</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🎬</text></svg>">
</head>

<body>
    <div class="app-background">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>

    <div class="app-container">
        <!-- 侧边栏导航 -->
        <aside class="sidebar glass-panel">
            <div class="logo-container">
                <div class="logo-icon">V</div>
                <h1>VeoMuse</h1>
            </div>

            <nav class="main-nav">
                <button class="nav-item active" data-tab="text">
                    <span class="icon">📝</span>
                    <span class="label">文字转视频</span>
                </button>
                <button class="nav-item" data-tab="image">
                    <span class="icon">🖼️</span>
                    <span class="label">图片转视频</span>
                </button>
                <button class="nav-item" data-tab="history">
                    <span class="icon">🕒</span>
                    <span class="label">创作历史</span>
                </button>
                <button class="nav-item" data-tab="api">
                    <span class="icon">🔌</span>
                    <span class="label">API 文档</span>
                </button>
            </nav>

            <div class="sidebar-footer">
                <button class="theme-toggle" id="theme-toggle" title="切换主题">
                    <span class="icon">🌙</span>
                </button>
                <div class="user-status">
                    <span class="status-dot"></span>
                    <span class="status-text">系统就绪</span>
                </div>
            </div>
        </aside>

        <!-- 主内容区域 -->
        <main class="main-content">
            <!-- 顶部栏 -->
            <header class="top-bar glass-panel">
                <div class="page-title">
                    <h2 id="page-title-text">文字转视频</h2>
                    <p id="page-subtitle-text">使用 Gemini Veo 模型将您的创意转化为精彩视频</p>
                </div>

                <div class="api-config">
                    <div class="api-input-wrapper">
                        <input type="password" id="api-key" placeholder="输入 Gemini API 密钥 (临时)">
                        <span class="input-icon">🔑</span>
                    </div>
                </div>
            </header>

            <!-- API警告提示 -->
            <div class="api-warning glass-panel warning-panel">
                <span class="icon">⚠️</span>
                <div class="warning-content">
                    <strong>需要付费 API 密钥：</strong> Gemini Veo 模型目前仅在付费层级可用。请确保您使用的是有效的付费 API 密钥。
                </div>
            </div>

            <!-- 内容区域 -->
            <div class="content-area-grid">

                <!-- 左侧：输入控制区 -->
                <div class="input-column">
                    <!-- 文字生成视频选项卡 -->
                    <div class="tab-content active" id="text-content">
                        <div class="two-column-layout">
                            <!-- 左侧：输入区域 -->
                            <div class="input-panel glass-panel">
                                <div class="panel-header">
                                    <h3>创意描述</h3>
                                    <div class="template-actions">
                                        <button id="random-template-text-btn" class="btn btn-sm btn-ghost">
                                            <span class="icon">🎲</span> 随机灵感
                                        </button>
                                        <button id="show-all-templates-btn" class="btn btn-sm btn-ghost">
                                            <span class="icon">📚</span> 模板库
                                        </button>
                                    </div>
                                </div>

                                <!-- 快速模板选择区 -->
                                <div id="template-categories-compact"></div>

                                <div class="form-group">
                                    <textarea id="text-input" class="premium-input textarea-full-height"
                                        placeholder="描述您想象中的画面... 例如：一只发光的透明水母在深邃的宇宙星空中游动，周围环绕着绚丽的星云，电影级光效，4k分辨率。"></textarea>
                                </div>
                            </div>

                            <!-- 右侧：控制区域 -->
                            <div class="controls-panel glass-panel">
                                <div class="panel-header">
                                    <h3>生成设置</h3>
                                </div>

                                <div class="controls-grid">
                                    <div class="control-item">
                                        <label>视频风格</label>
                                        <div class="select-wrapper">
                                            <select id="style-select-text" class="premium-select">
                                                <option value="">默认风格</option>
                                                <option value="写实风格">📸 写实风格</option>
                                                <option value="动画风格">🎨 动画风格</option>
                                                <option value="电影风格">🎬 电影风格</option>
                                                <option value="梦幻风格">🦄 梦幻风格</option>
                                                <option value="复古风格">📼 复古风格</option>
                                                <option value="科幻风格">🚀 科幻风格</option>
                                                <option value="3D渲染">🧊 3D渲染</option>
                                                <option value="水墨画">🖌️ 水墨画</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="control-item">
                                        <label>模型版本</label>
                                        <div class="select-wrapper">
                                            <select id="video-model-text" class="premium-select">
                                                <option value="veo-3.1-generate-preview">Veo 3.1 (Preview)</option>
                                                <option value="veo-3.1-fast-generate-preview">Veo 3.1 Fast</option>
                                                <option value="veo-3.0-generate-preview">Veo 3.0</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="advanced-options">
                                    <details>
                                        <summary>高级设置 <span class="arrow">▼</span></summary>
                                        <div class="advanced-content">
                                            <div class="form-group">
                                                <label>负面提示 (不希望出现的内容)</label>
                                                <input type="text" id="negative-prompt-text" class="premium-input"
                                                    placeholder="例如：模糊、变形、低质量、水印...">
                                            </div>

                                            <div class="optimize-row">
                                                <div class="optimize-control">
                                                    <label>提示词优化模型</label>
                                                    <select id="optimize-model-text" class="premium-select sm">
                                                        <option value="gemini-3.0-pro">Gemini 3.0 Pro</option>
                                                        <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                                                        <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                                                    </select>
                                                </div>
                                                <button id="optimize-text-btn" class="btn btn-secondary btn-icon-text">
                                                    <span class="icon">✨</span> AI 优化提示词
                                                </button>
                                            </div>

                                            <div class="optimized-prompt glass-panel inner-panel"
                                                id="optimized-text-prompt" style="display:none;">
                                                <div class="prompt-header">
                                                    <span class="icon">✨</span> 优化后的提示词
                                                </div>
                                                <p id="optimized-text-content"></p>
                                            </div>
                                        </div>
                                    </details>
                                </div>

                                <div class="action-area">
                                    <button id="generate-text-btn" class="btn btn-primary btn-lg btn-block btn-glow">
                                        <span class="icon">✨</span> 开始生成视频
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 图片生成视频选项卡 -->
                    <div class="tab-content" id="image-content">
                        <div class="input-panel glass-panel">
                            <div class="panel-header">
                                <h3>图片转视频</h3>
                                <div class="template-actions">
                                    <button id="random-template-image-btn" class="btn btn-sm btn-ghost">
                                        <span class="icon">🎲</span> 随机灵感
                                    </button>
                                </div>
                            </div>

                            <!-- 快速模板选择区 -->
                            <div id="template-categories-image"></div>

                            <div class="upload-area" id="upload-area">
                                <input type="file" id="image-input" accept="image/*" hidden>
                                <div class="upload-placeholder"
                                    onclick="document.getElementById('image-input').click()">
                                    <div class="upload-icon">☁️</div>
                                    <p>点击上传或拖拽图片到这里</p>
                                    <span class="upload-hint">支持 JPG, PNG, WebP</span>
                                </div>
                                <div id="image-preview-container" class="image-preview-container"
                                    style="display: none;">
                                    <img id="uploaded-image-preview" src="" alt="Preview">
                                    <button class="remove-image" id="remove-image-btn">×</button>
                                </div>
                            </div>

                            <div class="form-group">
                                <label>动态描述</label>
                                <textarea id="image-prompt" class="premium-input"
                                    placeholder="描述您希望图片如何动起来... 例如：镜头缓慢推进，瀑布流动，水雾缭绕。"></textarea>
                            </div>

                            <div class="controls-grid">
                                <div class="control-item">
                                    <label>视频风格</label>
                                    <div class="select-wrapper">
                                        <select id="style-select-image" class="premium-select">
                                            <option value="">默认风格</option>
                                            <option value="写实风格">📸 写实风格</option>
                                            <option value="动画风格">🎨 动画风格</option>
                                            <option value="电影风格">🎬 电影风格</option>
                                            <option value="梦幻风格">🦄 梦幻风格</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="control-item">
                                    <label>模型版本</label>
                                    <div class="select-wrapper">
                                        <select id="video-model-image" class="premium-select">
                                            <option value="veo-3.1-generate-preview">Veo 3.1 (Preview)</option>
                                            <option value="veo-3.1-fast-generate-preview">Veo 3.1 Fast</option>
                                            <option value="veo-3.0-generate-preview">Veo 3.0</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="advanced-options">
                                <details>
                                    <summary>高级设置 <span class="arrow">▼</span></summary>
                                    <div class="advanced-content">
                                        <div class="form-group">
                                            <label>负面提示</label>
                                            <input type="text" id="negative-prompt-image" class="premium-input"
                                                placeholder="不希望出现的内容...">
                                        </div>

                                        <div class="optimize-row">
                                            <div class="optimize-control">
                                                <div class="select-wrapper">
                                                    <select id="optimize-model-image" class="premium-select sm">
                                                        <option value="gemini-3.0-pro">Gemini 3.0 Pro</option>
                                                        <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                                                    </select>
                                                </div>
                                                <button id="optimize-image-btn" class="btn btn-secondary btn-icon-text">
                                                    <span class="icon">✨</span> AI 优化
                                                </button>
                                            </div>

                                            <div class="optimized-prompt glass-panel inner-panel"
                                                id="optimized-image-prompt" style="display:none;">
                                                <div class="prompt-header">
                                                    <span class="icon">✨</span> 优化结果
                                                </div>
                                                <p id="optimized-image-content"></p>
                                            </div>
                                        </div>
                                </details>
                            </div>
                        </div>
                    </div>

                    <!-- 历史记录选项卡 -->
                    <div class="tab-content" id="history-content">
                        <div class="glass-panel full-panel">
                            <div class="panel-header">
                                <h3>创作历史</h3>
                                <button id="clear-history-btn" class="btn btn-danger btn-sm">清空历史</button>
                            </div>
                            <div class="history-grid" id="history-list">
                                <!-- 历史记录项 -->
                            </div>
                            <div class="history-empty" id="history-empty" style="display: none;">
                                <div class="empty-icon">🕒</div>
                                <p>暂无历史记录</p>
                            </div>
                        </div>
                    </div>

                    <!-- API文档选项卡 -->
                    <div class="tab-content" id="api-content">
                        <div class="glass-panel full-panel">
                            <div class="panel-header">
                                <h3>API 参考文档</h3>
                                <div class="api-status">
                                    <span class="status-dot"></span>
                                    <span class="status-text">v1.0.0</span>
                                </div>
                            </div>

                            <div class="api-docs-content">
                                <!-- 认证部分 -->
                                <div class="api-section">
                                    <h4>🔐 认证鉴权</h4>
                                    <p class="endpoint-desc">所有 API 请求都需要在 Header 中包含 API 密钥。</p>
                                    <div class="code-block">
                                        Authorization: Bearer YOUR_API_KEY
                                    </div>
                                </div>

                                <!-- 核心接口 -->
                                <div class="api-section">
                                    <h4>🚀 核心接口</h4>

                                    <!-- 文字转视频 -->
                                    <div class="api-endpoint">
                                        <div class="endpoint-header">
                                            <span class="method-badge post">POST</span>
                                            <span class="endpoint-url">/api/generate-text</span>
                                        </div>
                                        <p class="endpoint-desc">根据文字描述生成视频。</p>

                                        <span class="code-label">请求参数 (JSON)</span>
                                        <table class="param-table">
                                            <thead>
                                                <tr>
                                                    <th>参数名</th>
                                                    <th>类型</th>
                                                    <th>说明</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td><span class="param-name">text</span><span
                                                            class="param-required">*</span></td>
                                                    <td><span class="param-type">string</span></td>
                                                    <td>视频内容的详细文字描述</td>
                                                </tr>
                                                <tr>
                                                    <td class="param-name">model</td>
                                                    <td><span class="param-type">string</span></td>
                                                    <td>模型版本 (默认: veo-3.1-preview)</td>
                                                </tr>
                                            </tbody>
                                        </table>

                                        <span class="code-label">示例请求</span>
                                        <div class="code-block">
                                            {
                                            "text": "一只发光的水母在太空中游动",
                                            "model": "veo-3.1-generate-preview"
                                            }
                                        </div>
                                    </div>
                                </div>

                                <!-- 图片转视频 -->
                                <div class="api-endpoint">
                                    <div class="endpoint-header">
                                        <span class="method-badge post">POST</span>
                                        <span class="endpoint-url">/api/generate-image</span>
                                    </div>
                                    <p class="endpoint-desc">让静态图片动起来。</p>

                                    <span class="code-label">请求参数 (FormData)</span>
                                    <table class="param-table">
                                        <tbody>
                                            <tr>
                                                <td><span class="param-name">image</span><span
                                                        class="param-required">*</span></td>
                                                <td><span class="param-type">file</span></td>
                                                <td>源图片文件 (JPG/PNG)</td>
                                            </tr>
                                            <tr>
                                                <td><span class="param-name">prompt</span><span
                                                        class="param-required">*</span></td>
                                                <td><span class="param-type">string</span></td>
                                                <td>指导运动的文字提示</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- 错误码 -->
                            <div class="api-section">
                                <h4>⚠️ 常见错误码</h4>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-name">401</span></td>
                                            <td>未授权 (API Key 无效)</td>
                                        </tr>
                                        <tr>
                                            <td><span class="param-name">429</span></td>
                                            <td>请求过于频繁 (Rate Limit)</td>
                                        </tr>
                                        <tr>
                                            <td><span class="param-name">500</span></td>
                                            <td>服务器内部错误</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 右侧：公共预览区 -->
            <div class="preview-column">
                <div class="preview-panel glass-panel sticky-panel">
                    <div class="empty-state" id="preview-empty-state">
                        <div class="empty-icon-wrapper">
                            <div class="empty-icon-bg"></div>
                            <div class="empty-icon">🎬</div>
                        </div>
                        <h3>准备创作精彩视频</h3>
                        <p class="empty-subtitle">按照以下步骤开始您的创作之旅</p>

                        <div class="steps-guide">
                            <div class="step-item">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <div class="step-title">输入创意</div>
                                    <div class="step-desc">描述您想要的视频内容</div>
                                </div>
                            </div>
                            <div class="step-item">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <div class="step-title">选择风格</div>
                                    <div class="step-desc">从多种预设风格中选择</div>
                                </div>
                            </div>
                            <div class="step-item">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <div class="step-title">生成视频</div>
                                    <div class="step-desc">AI 将在此展示结果</div>
                                </div>
                            </div>
                        </div>

                        <div class="empty-hint">
                            💡 提示：使用详细的描述可以获得更好的效果
                        </div>
                    </div>

                    <!-- 加载状态 -->
                    <div class="loading-state" id="loading" style="display: none;">
                        <div class="loader-container">
                            <div class="loader-ring"></div>
                            <div class="loader-core"></div>
                        </div>
                        <div class="loading-text">
                            <h3>正在创造奇迹...</h3>
                            <p id="status-text">初始化生成引擎</p>
                        </div>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progress"></div>
                            </div>
                        </div>
                    </div>

                    <!-- 结果显示 -->
                    <div class="result-display" id="result" style="display: none;">
                        <div class="video-wrapper" id="video-container"></div>

                        <div class="result-actions">
                            <button id="download-btn" class="btn btn-secondary">
                                <span class="icon">⬇️</span> 下载原片
                            </button>
                            <button id="copy-link-btn" class="btn btn-secondary">
                                <span class="icon">📋</span> 复制链接
                            </button>
                            <button class="btn btn-secondary"
                                onclick="document.getElementById('conversion-tools').style.display = document.getElementById('conversion-tools').style.display === 'none' ? 'block' : 'none'">
                                <span class="icon">🔄</span> 格式转换
                            </button>
                        </div>

                        <div class="conversion-tools glass-panel inner-panel" id="conversion-tools"
                            style="display:none">
                            <h4>视频转换工具</h4>
                            <div class="tools-grid">
                                <div class="tool-group">
                                    <label>格式</label>
                                    <select id="convert-format" class="premium-select sm">
                                        <option value="mp4">MP4</option>
                                        <option value="webm">WebM</option>
                                        <option value="mov">MOV</option>
                                    </select>
                                </div>
                                <div class="tool-group">
                                    <label>分辨率</label>
                                    <select id="convert-resolution" class="premium-select sm">
                                        <option value="">原始</option>
                                        <option value="1080p">1080p</option>
                                        <option value="720p">720p</option>
                                    </select>
                                </div>
                                <button id="convert-btn" class="btn btn-primary btn-sm">开始转换</button>
                            </div>

                            <div class="transcode-status" id="transcode-progress" style="display: none;">
                                <div class="status-text" id="transcode-status-text">转换中...</div>
                                <div class="progress-bar sm">
                                    <div class="progress-fill" id="transcode-progress-bar"></div>
                                </div>
                            </div>

                            <div class="conversion-result" id="conversion-preview" style="display: none;">
                                <div id="converted-video-container"></div>
                                <button id="download-converted-btn"
                                    class="btn btn-success btn-sm btn-block">下载转换视频</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </div>
    </main>
    </div>

    <!-- 通知提示 -->
    <div class="notification-container" id="notification"></div>

    <!-- 模板弹窗 -->
    <div class="modal-overlay" id="template-modal" style="display: none;">
        <div class="modal-glass">
            <div class="modal-header">
                <h2>🎨 灵感库</h2>
                <button class="close-btn" id="close-template-modal">×</button>
            </div>
            <div class="modal-body">
                <div class="template-categories" id="template-categories-modal">
                    <!-- 动态生成 -->
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript模块 -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/ui-managers.js"></script>
    <script src="/js/api-client.js"></script>
    <script src="/js/app.js"></script>
    <script src="/js/features.js"></script>

    <script>
        // Tab 切换逻辑
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                item.classList.add('active');

                const tabId = item.getAttribute('data-tab');
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                document.getElementById(tabId + '-content').classList.add('active');

                // 更新标题
                const titles = {
                    'text': '文字转视频',
                    'image': '图片转视频',
                    'history': '创作历史',
                    'api': 'API 文档'
                };
                document.getElementById('page-title-text').textContent = titles[tabId];

                // 控制右侧预览面板的显示
                const previewColumn = document.querySelector('.preview-column');
                if (tabId === 'text' || tabId === 'image') {
                    previewColumn.style.display = 'block';
                    document.querySelector('.content-area-grid').style.gridTemplateColumns = '1fr 1fr';
                } else {
                    previewColumn.style.display = 'none';
                    document.querySelector('.content-area-grid').style.gridTemplateColumns = '1fr';
                }
            });
        });

        // 模态框关闭逻辑
        document.getElementById('close-template-modal').addEventListener('click', () => {
            document.getElementById('template-modal').style.display = 'none';
        });

        // 简单的通知显示函数，如果原 JS 没覆盖到
        window.showNotification = function (message, type = 'info') {
            const container = document.getElementById('notification');
            const notif = document.createElement('div');
            notif.className = `notification ${type}`;
            notif.textContent = message;
            container.appendChild(notif);
            setTimeout(() => {
                notif.remove();
            }, 3000);
        };
    </script>
</body>

</html>