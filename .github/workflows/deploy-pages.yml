# GitHub Pages éƒ¨ç½²å·¥ä½œæµ
name: Deploy GitHub Pages

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  # æ„å»ºä½œä¸š
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          
      - name: Install dependencies
        run: npm ci
        
      - name: Run tests
        run: npm test
        
      - name: Build documentation
        run: |
          mkdir -p docs
          cp README.md docs/
          cp API_DOCUMENTATION.md docs/
          cp -r image docs/
          cp screenshot.png docs/
          
      - name: Create index.html for GitHub Pages
        run: |
          cat > docs/index.html << 'EOF'
          <!DOCTYPE html>
          <html lang="zh-CN">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>VeoMuse - æ–‡å­—/å›¾ç‰‡ç”Ÿæˆè§†é¢‘</title>
              <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
              <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.1.0/github-markdown.min.css">
              <style>
                  .markdown-body { max-width: 980px; margin: 0 auto; padding: 45px; }
                  .hero { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
              </style>
          </head>
          <body class="bg-gray-50">
              <div class="hero text-white py-20">
                  <div class="container mx-auto text-center">
                      <h1 class="text-5xl font-bold mb-4">VeoMuse</h1>
                      <p class="text-xl mb-8">ä½¿ç”¨Google Gemini Veoæ¨¡å‹å°†æ–‡å­—æˆ–å›¾ç‰‡ç”Ÿæˆè§†é¢‘çš„Webåº”ç”¨ç¨‹åº</p>
                      <div class="flex justify-center space-x-4">
                          <a href="https://github.com/MisonL/VeoMuse" class="bg-white text-purple-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition">
                              ğŸ“¦ GitHub ä»“åº“
                          </a>
                          <a href="#documentation" class="border-2 border-white text-white px-6 py-3 rounded-lg font-semibold hover:bg-white hover:text-purple-600 transition">
                              ğŸ“– æŸ¥çœ‹æ–‡æ¡£
                          </a>
                      </div>
                  </div>
              </div>
              
              <div class="container mx-auto py-12">
                  <div class="grid md:grid-cols-2 gap-8 mb-12">
                      <div class="bg-white p-6 rounded-lg shadow-lg">
                          <h3 class="text-2xl font-bold mb-4 text-gray-800">ğŸ¬ ä¸»è¦åŠŸèƒ½</h3>
                          <ul class="space-y-2 text-gray-600">
                              <li>ğŸ“ æ–‡å­—ç”Ÿæˆè§†é¢‘</li>
                              <li>ğŸ–¼ï¸ å›¾ç‰‡ç”Ÿæˆè§†é¢‘</li>
                              <li>ğŸš« è´Ÿé¢æç¤ºæ”¯æŒ</li>
                              <li>ğŸ”‘ å¤šAPIå¯†é’¥æ”¯æŒ</li>
                              <li>â–¶ï¸ è§†é¢‘åœ¨çº¿é¢„è§ˆ</li>
                              <li>ğŸ”„ è§†é¢‘è½¬ç åŠŸèƒ½</li>
                              <li>ğŸ¨ æç¤ºè¯æ¨¡æ¿åº“</li>
                              <li>ğŸ“ˆ å®æ—¶ç”ŸæˆçŠ¶æ€</li>
                          </ul>
                      </div>
                      
                      <div class="bg-white p-6 rounded-lg shadow-lg">
                          <h3 class="text-2xl font-bold mb-4 text-gray-800">âš¡ æŠ€æœ¯ç‰¹æ€§</h3>
                          <ul class="space-y-2 text-gray-600">
                              <li>ğŸ—ï¸ Node.js + Express åç«¯</li>
                              <li>ğŸ¨ å“åº”å¼å‰ç«¯è®¾è®¡</li>
                              <li>ğŸ”’ å¤šå±‚å®‰å…¨é˜²æŠ¤</li>
                              <li>ğŸ“Š ç»“æ„åŒ–æ—¥å¿—ç³»ç»Ÿ</li>
                              <li>ğŸ”„ æ™ºèƒ½è½®è¯¢æœºåˆ¶</li>
                              <li>ğŸ“¦ æ‰¹é‡è§†é¢‘ç”Ÿæˆ</li>
                              <li>âš¡ GPUåŠ é€Ÿæ”¯æŒ</li>
                              <li>ğŸŒ— æ·±è‰²/æµ…è‰²ä¸»é¢˜</li>
                          </ul>
                      </div>
                  </div>
                  
                  <div class="bg-white rounded-lg shadow-lg p-8 mb-8">
                      <h2 class="text-3xl font-bold mb-6 text-gray-800">ğŸ“¸ åº”ç”¨æˆªå›¾</h2>
                      <img src="screenshot.png" alt="VeoMuseç•Œé¢æˆªå›¾" class="w-full rounded-lg shadow-md">
                  </div>
              </div>
              
              <div id="documentation" class="bg-gray-100 py-12">
                  <div class="container mx-auto">
                      <h2 class="text-3xl font-bold text-center mb-8 text-gray-800">ğŸ“š é¡¹ç›®æ–‡æ¡£</h2>
                      <div class="grid md:grid-cols-2 gap-6">
                          <a href="README.html" class="bg-white p-6 rounded-lg shadow-lg hover:shadow-xl transition">
                              <h3 class="text-xl font-semibold mb-2 text-blue-600">ğŸ“– é¡¹ç›®è¯´æ˜</h3>
                              <p class="text-gray-600">è¯¦ç»†çš„é¡¹ç›®ä»‹ç»ã€å®‰è£…æŒ‡å—å’Œä½¿ç”¨è¯´æ˜</p>
                          </a>
                          <a href="API_DOCUMENTATION.html" class="bg-white p-6 rounded-lg shadow-lg hover:shadow-xl transition">
                              <h3 class="text-xl font-semibold mb-2 text-green-600">ğŸ”Œ APIæ–‡æ¡£</h3>
                              <p class="text-gray-600">å®Œæ•´çš„APIæ¥å£æ–‡æ¡£å’Œä½¿ç”¨ç¤ºä¾‹</p>
                          </a>
                      </div>
                  </div>
              </div>
              
              <footer class="bg-gray-800 text-white py-8">
                  <div class="container mx-auto text-center">
                      <p>&copy; 2025 VeoMuse - åŸºäºGoogle Gemini Veoæ¨¡å‹çš„è§†é¢‘ç”Ÿæˆå·¥å…·</p>
                      <p class="mt-2 text-gray-400">MIT License</p>
                  </div>
              </footer>
          </body>
          </html>
          EOF
          
      - name: Convert Markdown to HTML
        run: |
          npm install -g marked
          marked README.md > docs/README.html
          marked API_DOCUMENTATION.md > docs/API_DOCUMENTATION.html
          
      - name: Setup Pages
        uses: actions/configure-pages@v4
        
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: './docs'

  # éƒ¨ç½²ä½œä¸š
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4